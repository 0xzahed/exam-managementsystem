document.addEventListener("DOMContentLoaded",function(){console.log("Profile student settings page loaded");const a=document.getElementById("student-profile-form");a&&a.addEventListener("submit",function(e){const s=document.getElementById("first_name").value.trim(),i=document.getElementById("last_name").value.trim(),t=document.getElementById("email").value.trim();if(!s||!i||!t){e.preventDefault(),showError("Please fill in all required fields");return}if(!u(t)){e.preventDefault(),showError("Please enter a valid email address");return}const n=this.querySelector('button[type="submit"]');n&&(n.disabled=!0,n.innerHTML='<i class="fas fa-spinner fa-spin mr-2"></i>Saving...')});const l=document.querySelector('form[action*="password"]');if(l){l.addEventListener("submit",function(i){const t=document.getElementById("current_password").value,n=document.getElementById("password").value,o=document.getElementById("password_confirmation").value;if(!t||!n||!o){i.preventDefault(),showError("Please fill in all password fields");return}if(n!==o){i.preventDefault(),showError("New passwords do not match");return}if(n.length<8){i.preventDefault(),showError("Password must be at least 8 characters long");return}const r=this.querySelector('button[type="submit"]');r&&(r.disabled=!0,r.innerHTML='<i class="fas fa-spinner fa-spin mr-2"></i>Updating...')});const e=document.getElementById("password"),s=document.getElementById("password_confirmation");e&&s&&s.addEventListener("input",function(){const i=e.value,t=this.value;t&&i!==t?(this.classList.add("border-red-500"),this.classList.remove("border-gray-300")):t&&i===t?(this.classList.remove("border-red-500"),this.classList.add("border-green-500")):(this.classList.remove("border-red-500","border-green-500"),this.classList.add("border-gray-300"))})}const c=document.getElementById("profile-photo-input");c&&c.addEventListener("change",function(e){const s=e.target.files[0];if(s){if(!["image/jpeg","image/jpg","image/png","image/gif"].includes(s.type)){showError("Please select a valid image file (JPG, PNG, or GIF)"),this.value="";return}if(s.size>5*1024*1024){showError("Image file size must be less than 5MB"),this.value="";return}const t=document.querySelector(".profile-photo-preview");if(t){const n=new FileReader;n.onload=function(o){if(t.tagName==="IMG")t.src=o.target.result;else{const r=document.createElement("img");r.src=o.target.result,r.className=t.className,r.alt="Profile",t.parentNode.replaceChild(r,t)}},n.readAsDataURL(s)}}});const d=document.getElementById("phone");if(d&&d.addEventListener("input",function(){let e=this.value.replace(/\D/g,"");e.length>=6?e=`(${e.slice(0,3)}) ${e.slice(3,6)}-${e.slice(6,10)}`:e.length>=3&&(e=`(${e.slice(0,3)}) ${e.slice(3)}`),this.value=e}),new URLSearchParams(window.location.search).get("success")){const e=document.querySelector('meta[name="session-success"]'),s=e?e.getAttribute("content"):"Profile updated successfully!";window.notificationManager?window.notificationManager.show(s,"success"):setTimeout(()=>{window.notificationManager?window.notificationManager.show(s,"success"):showSuccess(s)},100),window.history.replaceState({},document.title,window.location.pathname)}});function u(a){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a)}
