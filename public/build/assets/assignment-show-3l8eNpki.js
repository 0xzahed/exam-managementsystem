document.addEventListener("DOMContentLoaded",function(){m(),p(),E(),y()});function m(){const e=document.getElementById("fileInput");document.getElementById("fileInfo"),document.getElementById("fileName"),e&&e.addEventListener("change",function(t){const n=t.target.files;n.length>0?f(n):u()})}function p(){const e=document.getElementById("dropZone"),t=document.getElementById("fileInput");if(!e||!t)return;["dragenter","dragover","dragleave","drop"].forEach(o=>{e.addEventListener(o,n,!1),document.body.addEventListener(o,n,!1)}),["dragenter","dragover"].forEach(o=>{e.addEventListener(o,s,!1)}),["dragleave","drop"].forEach(o=>{e.addEventListener(o,l,!1)}),e.addEventListener("drop",a,!1),e.addEventListener("click",function(o){(o.target===e||o.target.closest("#dropZoneContent"))&&t.click()});function n(o){o.preventDefault(),o.stopPropagation()}function s(){e.classList.add("border-blue-400","bg-blue-50")}function l(){e.classList.remove("border-blue-400","bg-blue-50")}function a(o){const i=o.dataTransfer.files;t.files=i,f(i)}}function f(e){const t=document.getElementById("fileInfo"),n=document.getElementById("fileName");!t||!n||(e.length===1?n.textContent=`${e[0].name} (${h(e[0].size)})`:n.textContent=`${e.length} files selected`,t.classList.remove("hidden"))}function u(){const e=document.getElementById("fileInfo");e&&e.classList.add("hidden")}function g(){const e=document.getElementById("fileInput");e&&(e.value="",u())}function h(e){if(e===0)return"0 Bytes";const t=1024,n=["Bytes","KB","MB","GB"],s=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/Math.pow(t,s)).toFixed(2))+" "+n[s]}function E(){const e=document.getElementById("submissionForm");e&&e.addEventListener("submit",function(t){const n=document.querySelector("[data-submission-type]"),s=n?n.dataset.submissionType:"file",l=document.getElementById("fileInput"),a=document.querySelector('textarea[name="submission_text"]');let o=l&&l.files&&l.files.length>0,r=a&&a.value.trim().length>0;if(s==="file"&&!o)return t.preventDefault(),d("Please select at least one file to upload."),!1;if(s==="text"&&!r)return t.preventDefault(),d("Please enter your assignment text."),!1;if(s==="both"&&!o&&!r)return t.preventDefault(),d("Please provide either a file upload or text submission."),!1;const i=e.querySelector('button[type="submit"]');if(i){const c=i.innerHTML;i.innerHTML='<i class="fas fa-spinner fa-spin mr-2"></i>Submitting...',i.disabled=!0,setTimeout(()=>{i.innerHTML=c,i.disabled=!1},3e4)}})}function y(){document.querySelectorAll("[data-tooltip]").forEach(t=>{t.addEventListener("mouseenter",I),t.addEventListener("mouseleave",v)})}function I(e){const t=document.createElement("div");t.className="absolute bg-gray-800 text-white text-xs rounded py-1 px-2 z-50",t.textContent=e.target.dataset.tooltip,t.id="tooltip",document.body.appendChild(t);const n=e.target.getBoundingClientRect();t.style.left=n.left+n.width/2-t.offsetWidth/2+"px",t.style.top=n.top-t.offsetHeight-5+"px"}function v(){const e=document.getElementById("tooltip");e&&e.remove()}window.clearFile=g;function d(e){window.notificationManager?window.notificationManager.show(e,"error"):window.showError?window.showError(e):alert(e)}window.showSuccessMessage=showSuccessMessage;
